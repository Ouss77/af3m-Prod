(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[737],{1310:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin_pages/modifierUtilisateur",function(){return r(747)}])},747:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(4848),a=r(6540),l=r(6456),n=r(8869),c=r(6887);let d=function(){let e=(0,a.useContext)(l.s).language,[t,r]=(0,a.useState)([]),[d,o]=(0,a.useState)(!0),[i,u]=(0,a.useState)(null),[x,h]=(0,a.useState)({username:"",password:""}),[p,m]=(0,a.useState)({text:"",type:""}),[y,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{f()},[]);let f=async()=>{try{let e=await fetch("".concat("http://localhost/AF3M-Backend","/getUsers.php")),t=await e.json();r(t),o(!1)}catch(e){m({text:"An error occurred while fetching users.",type:"error"})}finally{o(!1)}},w=async e=>{try{(await fetch("".concat("http://localhost/AF3M-Backend","/deleteUser.php"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok?(r(t.filter(t=>t.id!==e)),m({text:"User deleted successfully",type:"success"})):m({text:"Failed to delete the user",type:"error"})}catch(e){m({text:"An error occurred while deleting the user",type:"error"})}},g=e=>{u(e.id),h({username:e.username,password:e.password})},j=e=>{let{name:t,value:r}=e.target;h(e=>({...e,[t]:r}))},N=async()=>{let{username:e,password:s}=x;if(!e||!s){m({text:"Username and password are required",type:"error"});return}let a={id:i,username:e,password:s};try{let e;let s=await fetch("".concat("http://localhost/AF3M-Backend","/editUser.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){m({text:"Error: ".concat(s.statusText),type:"error"});return}let l=await s.text();if(""===l.trim()){m({text:"An empty response was returned from the server.",type:"error"});return}try{e=JSON.parse(l)}catch(e){m({text:"An error occurred: Invalid response from server",type:"error"});return}e.success?(r(t.map(e=>e.id===i?a:e)),m({text:"User updated successfully",type:"success"}),u(null)):m({text:"Error: ".concat(e.message),type:"error"})}catch(e){m({text:"An error occurred while updating the user",type:"error"})}},v=()=>{u(null)};return((0,a.useEffect)(()=>{if(p.text){let e=setTimeout(()=>m({text:"",type:""}),4e3);return()=>clearTimeout(e)}},[p]),d)?(0,s.jsx)("div",{className:"ml-20",children:(0,s.jsx)(c.A,{})}):y?(0,s.jsxs)("div",{className:"text-center text-red-600 py-10",children:["Error: ",y]}):(0,s.jsxs)("div",{className:"p-6 max-w-4xl mx-52 mt-20",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"fr"===e?"Tous les utilisateurs":"All Users"}),p.text&&(0,s.jsx)("div",{className:"fixed top-0 left-0 w-full py-2 text-center text-white ".concat("success"===p.type?"bg-green-500":"bg-red-500"),children:p.text}),(0,s.jsx)("button",{"aria-label":"Add News",onClick:()=>window.location.href="/admin_pages/ajouterUtilisateur",className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-700",children:"fr"===e?"Ajouter Utilisateur":"Add User"}),(0,s.jsxs)("table",{className:"min-w-full mt-2 bg-white border border-gray-200 shadow-md rounded-lg overflow-hidden",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-black h-14 text-white text-center",children:[(0,s.jsx)("th",{className:"py-2 px-4 border-b",children:"Username"}),(0,s.jsx)("th",{className:"py-2 px-4 border-b",children:"Password"}),(0,s.jsx)("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:t.map(e=>(0,s.jsxs)("tr",{className:"text-center border-t  hover:bg-gray-100 h-16",children:[(0,s.jsx)("td",{className:"py-2 px-4 border-b ",children:i===e.id?(0,s.jsx)("input",{type:"text",name:"username",value:x.username,onChange:j,className:"w-full p-2 border rounded-lg"}):e.username}),(0,s.jsx)("td",{className:"py-2 px-4 border-b",children:i===e.id?(0,s.jsx)("input",{type:"password",name:"password",value:x.password,onChange:j,className:"w-full p-2 border rounded-lg"}):e.password}),(0,s.jsx)("td",{className:"py-2 px-4 border-b flex",children:i===e.id?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:N,className:"text-green-500 hover:text-green-700 mx-2",children:"Save"}),(0,s.jsx)("button",{onClick:v,className:"text-gray-500 hover:text-gray-700 mx-2",children:"Cancel"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>g(e),className:"text-blue-500 hover:text-blue-700 mx-2",children:(0,s.jsx)(n.SG1,{size:20})}),(0,s.jsx)("button",{onClick:()=>w(e.id),className:"text-red-500 hover:text-red-700 mx-2",children:(0,s.jsx)(n.Q_v,{size:20})})]})})]},e.id))})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[465,636,593,792],()=>t(1310)),_N_E=e.O()}]);